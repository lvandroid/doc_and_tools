# 移动端与Web和服务端交互问题汇总

## 移动端和Web的那些事

### JsBridge交互问题

#### 生命周期问题

**现象:**

1. token失效;

    h5页面需要页面加载开始就从native获取token，ios正常，android获取失败

2. 页面初始化调用native方法失败


**原因:**

ios和android的jsbridge需要使用不同的js代码，h5端只import了ios的jsbridge，没有import android的jsbridge代码导致

### 不要标题栏的h5问题

有部分h5页面，比如抽奖，期望设计成没有标题栏的h5，由于h5的url的不定性，在统一封装的webview中去处理标题栏的显示隐藏会出现标题栏短暂显示的问题

> ***尽量避免这种设计***

### 单页回退问题:

**现象:**

页面回退不了，可以回退的页面也会直接关闭页面

**原因:**

页面路由方案导致的调用canBack()判断是否可以回退无效

> 更换路由方案可解决

## 移动端和服务端接口问题

### 接口无效字段太多

移动端需要的返回数据字段较少，服务端返回了整个业务是实体类数据，加上字段的业务属性辨识度不高，导致移动端选取字段困难，增加了开发和沟通成本, 

典型案例: 优惠券接口

### err_msg 返回不够规范

err_msg 部分接口返回比较随意，增加测试成本

**建议:**

服务端封装一个统一的err类，并提供相应的文档：所有err_code和err_msg都从里面取，统一维护这个类即可

### responseData 空值返回不够规范

案例:

将空列表的data返回为空字符串，将空对象返回为空字符串

**结果:**

移动端解析数据异常,增加调试成本



